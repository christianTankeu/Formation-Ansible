# Author: Christian TANKEU
# Pseudo: GhostSecurity
# Email: tankeuchristian1@gmail.com

- name: TEST VARIABLE ENREGISTREE
  hosts: datacenter

  tasks:
    - name: Lister les fichers
      ansible.builtin.command:
        cmd: ls -l
      when:
        - ansible_facts['os_family'] == "Debian"
        - ansible_facts['lsb']['major_release'] == "19"
      register: list
    - name: Recuperer la liste des repertoires home
      ansible.builtin.command:
        cmd: ls /home
      changed_when: false
      register: home_dirs
    - name: Lister les repertoires home_dirs
      ansible.builtin.debug:
        msg: "{{ home_dirs.stdout_lines }}"

- name: TEST VARIABLE
  hosts: webservers

  vars:
    epic: true
    monumental: "yes"

  tasks:
    - name: Lancer la commande si epic ou monumental est vraie
      ansible.builtin.command:
        cmd: echo "C'est epic"
      when: epic or monumental | bool
    - name: Lancer la commande si epic est faux
      ansible.builtin.command:
        cmd: echo "c'est pas epic"
      when: not epic

- name: Tests
  hosts: webservers

  vars_files:
    - "vars/common.yaml"
    - ["vars/{{ ansible_facts['os_family'] }}.yaml", "vars/os_defaults.yaml"]
